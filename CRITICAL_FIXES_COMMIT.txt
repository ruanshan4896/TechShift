fix(critical): Prevent draft leak & sync raw_articles deletion

ðŸš¨ Critical Security & Data Integrity Fixes

## Fix 1: Prevent Draft Articles from Leaking to Public Website

Problem:
- Website was displaying DRAFT articles on all public pages
- Users could access draft content via direct URL
- Search was indexing draft content
- Security issue: Unpublished content exposed

Solution:
- Added `WHERE status = 'PUBLISHED'` filter to ALL public queries
- Fixed 15 database functions in apps/website/lib/db.ts

Functions fixed:
âœ… getLatestArticles() - Homepage
âœ… getArticleBySlug() - Article detail page
âœ… findRelatedArticles() - Related articles
âœ… getArticlesByCategory() - Category pages
âœ… getArticlesByTag() - Tag pages
âœ… searchArticles() - Search functionality
âœ… getFeaturedArticles() - Featured section
âœ… getRelatedArticlesByTags() - Related by tags
âœ… getTotalArticlesCount() - Article count
âœ… getTotalArticlesByCategory() - Category count
âœ… getTotalArticlesByTag() - Tag count
âœ… getLatestArticlesPaginated() - Pagination
âœ… getArticlesByCategoryPaginated() - Category pagination
âœ… getArticlesByTagPaginated() - Tag pagination
âœ… getPopularTags() - Popular tags (only count published)

Impact:
âœ… All public pages now only show PUBLISHED articles
âœ… Direct access to draft returns 404
âœ… Search only finds published content
âœ… Pagination counts only published articles
âœ… Tags only count from published articles

---

## Fix 2: Sync raw_articles Deletion with Article Deletion

Problem:
- Deleting article in admin didn't delete raw_articles record
- System reported "Duplicate" when trying to re-fetch from RSS
- Couldn't re-process deleted articles
- Admin workflow broken

Solution:
- Modified DELETE APIs to also delete related raw_articles
- Match by title and slug (ILIKE for case-insensitive)
- Allows re-fetching and re-processing after deletion

Files modified:
* apps/admin/app/api/articles/[id]/route.ts - Single delete
* apps/admin/app/api/articles/bulk-delete/route.ts - Bulk delete

Logic:
```typescript
// 1. Get article info before deleting
const article = await sql`SELECT title, slug FROM articles WHERE id = ${id}`;

// 2. Delete article
await sql`DELETE FROM articles WHERE id = ${id}`;

// 3. Delete related raw_articles
await sql`
  DELETE FROM raw_articles 
  WHERE title ILIKE ${`%${article.title}%`}
  OR title ILIKE ${`%${article.slug}%`}
`;
```

Impact:
âœ… Single delete removes raw_articles
âœ… Bulk delete removes all raw_articles
âœ… Can re-fetch deleted articles from RSS
âœ… Can re-process articles from scratch
âœ… No more "Duplicate" errors
âœ… Improved admin workflow

---

ðŸ“¦ Files Modified:
* apps/website/lib/db.ts - 15 functions fixed
* apps/admin/app/api/articles/[id]/route.ts - Single delete
* apps/admin/app/api/articles/bulk-delete/route.ts - Bulk delete

ðŸ“š Documentation:
+ CRITICAL_FIXES_SUMMARY.md - Detailed explanation
+ TEST_CRITICAL_FIXES.md - Testing guide

ðŸ§ª Testing:
- Test 1: Verify drafts not visible on website
- Test 2: Verify direct access to draft returns 404
- Test 3: Verify delete removes raw_articles
- Test 4: Verify can re-fetch after delete

ðŸŽ¯ Results:
âœ… Security: Draft content no longer exposed
âœ… Data Integrity: raw_articles synced with articles
âœ… Workflow: Can re-fetch and re-process deleted articles
âœ… User Experience: Only published content visible

Priority: Critical
Type: Security + Data Integrity
Breaking: No
Backward compatible: Yes

Co-authored-by: Kiro AI Assistant <kiro@example.com>
